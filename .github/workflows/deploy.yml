- name: Deploy to EC2
  uses: appleboy/ssh-action@v0.1.6
  with:
    host: ${{ secrets.EC2_HOST }}
    username: ec2-user
    key: ${{ secrets.EC2_KEY }}
    port: 22
    script: |
      sudo yum update -y
      sudo yum install -y python3 python3-pip
      cd /tmp/python-demo
      pip3 install -r requirements.txt
      nohup python3 app.py > app.log 2>&1 &
      echo "App started. Checking process..."
      ps aux | grep app.py | grep -v grep
